<?xml version="1.0"?>
<Setup StateDatabaseLocation="C:\Users\Administrator\Documents\Vicente\TSS-FILE-CONVERTER\WFM\WFM_LOGS\1_WFM_import_export.db">
    <Log TimingLog="C:\Users\Administrator\Documents\Vicente\TSS-FILE-CONVERTER\WFM\WFM_LOGS\2_Timing_WFM_import_export.csv"/>
	<Log ErrorLog="C:\Users\Administrator\Documents\Vicente\TSS-FILE-CONVERTER\WFM\WFM_LOGS\3_Error_WFM_import_export.csv"/>
	<Log InfoLogFile="C:\Users\Administrator\Documents\Vicente\TSS-FILE-CONVERTER\WFM\WFM_LOGS\4_InfoLogFile_WFM_import_export.txt"/>	
				
	<GroupTask name="Export Visualsoft Navigation Data">

        <GroupTask name="Define variables">
            <SetPropertyTask po="2" name="Output directory" input="C:\Users\Administrator\Documents\Vicente\TSS-FILE-CONVERTER\TEST DATA\WFM_exports" output="OutputDirectory" level="2"/>
            <SetPropertyTask po="2" name="CRP ID" input="1" output="crp_id" level="2"/>
            <SetPropertyTask po="2" name="PORT ID" input="2" output="port_id" level="2"/>
            <SetPropertyTask po="2" name="CENTER ID" input="3" output="center_id" level="2"/>
            <SetPropertyTask po="2" name="STBD ID" input="4" output="stbd_id" level="2"/>
            <SetPropertyTask po="2" name="Database Name" input="600090_GOEL_WindMultiplikator" output="NE_database" level="2"/>
            <SetPropertyTask po="2" name="Block ID" input="53" output="block_id" level="2"/>
        </GroupTask>

        <ExportVisualSoftNavigationTask po="1" name="Export Visualsoft Nav CRP" logKeyword="NAVxport" output=" ">
        <NaviEditTask version="1.0">
            <SqlServer>localhost</SqlServer>
            <DatabaseName>{NE_database}</DatabaseName>
            <Export type="xyvsoftvev">
            <BlockId>
                {block_id}
            </BlockId>

            <Output>
                <Location outputMethod="0" prefixKPRange="no" combineFiles="no" sortCombined="no">
                    <Path>"{OutputDirectory}"</Path>
                    <AppendPath></AppendPath>
                </Location>

                <DbFolderUsage createSubdir="no" prefixFileName="no" useAsFilename="no"/>
                <Options writeHeader="yes" selectionMethod="0" reduceMethod="0" sortKP="no" interval="10.0"/>
                <!-- interval unit meter-->
            </Output>
            <Units depthScale="1.0" posScale="1.0"/>
            <!-- depth scale is positive down -->
            <Settings>
                <Selection object="{crp_id}"/> 
                       <!-- object:
                        -2 = depth channel
                        -1 = CRP
                        0 = User Selected specify in UserOffset element below
                        n = UserOffset Id in the NaviEdit database
                        -->
                <Singlebeam maxInterpolDist="-1" interpolateDepth="yes"/>
                <Multibeam averagingWindow="1.0"/> 
                <!-- averaging windows i meter -->
                <NoOfDecimals position="3" depth="3" />
                <Options downsampleFactor="0" downsampleMinDist="0.0" timeFormat="0" />
                <!-- timeFormat 0 = Default -->
            </Settings>
            </Export>
        </NaviEditTask>
        </ExportVisualSoftNavigationTask>

        <ExportVisualSoftNavigationTask po="2" name="Export Visualsoft Nav PORT Coil" logKeyword="NAVxport" output=" ">
        <NaviEditTask version="1.0">
            <SqlServer>localhost</SqlServer>
            <DatabaseName>{NE_database}</DatabaseName>
            <Export type="xyvsoftvev">
            <BlockId>
                {block_id}
            </BlockId>

            <Output>
                <Location outputMethod="0" prefixKPRange="no" combineFiles="no" sortCombined="no">
                    <Path>"{OutputDirectory}"</Path>
                    <AppendPath></AppendPath>
                </Location>

                <DbFolderUsage createSubdir="no" prefixFileName="no" useAsFilename="no"/>
                <Options writeHeader="yes" selectionMethod="0" reduceMethod="0" sortKP="no" interval="10.0"/>
                <!-- interval unit meter-->
            </Output>
            <Units depthScale="1.0" posScale="1.0"/>
            <!-- depth scale is positive down -->
            <Settings>
                <Selection object="{port_id}"/> 
                       <!-- object:
                        -2 = depth channel
                        -1 = CRP
                        0 = User Selected specify in UserOffset element below
                        n = UserOffset Id in the NaviEdit database
                        -->
                <Singlebeam maxInterpolDist="-1" interpolateDepth="yes"/>
                <Multibeam averagingWindow="1.0"/> 
                <!-- averaging windows i meter -->
                <NoOfDecimals position="3" depth="3" />
                <Options downsampleFactor="0" downsampleMinDist="0.0" timeFormat="0" />
                <!-- timeFormat 0 = Default -->
            </Settings>
            </Export>
        </NaviEditTask>
        </ExportVisualSoftNavigationTask>

        <ExportVisualSoftNavigationTask po="3" name="Export Visualsoft Nav CENTER Coil" logKeyword="NAVxport" output=" ">
        <NaviEditTask version="1.0">
            <SqlServer>localhost</SqlServer>
            <DatabaseName>{NE_database}</DatabaseName>
            <Export type="xyvsoftvev">
            <BlockId>
                {block_id}
            </BlockId>

            <Output>
                <Location outputMethod="0" prefixKPRange="no" combineFiles="no" sortCombined="no">
                    <Path>"{OutputDirectory}"</Path>
                    <AppendPath></AppendPath>
                </Location>

                <DbFolderUsage createSubdir="no" prefixFileName="no" useAsFilename="no"/>
                <Options writeHeader="yes" selectionMethod="0" reduceMethod="0" sortKP="no" interval="10.0"/>
                <!-- interval unit meter-->
            </Output>
            <Units depthScale="1.0" posScale="1.0"/>
            <!-- depth scale is positive down -->
            <Settings>
                <Selection object="{center_id}"/> 
                       <!-- object:
                        -2 = depth channel
                        -1 = CRP
                        0 = User Selected specify in UserOffset element below
                        n = UserOffset Id in the NaviEdit database
                        -->
                <Singlebeam maxInterpolDist="-1" interpolateDepth="yes"/>
                <Multibeam averagingWindow="1.0"/> 
                <!-- averaging windows i meter -->
                <NoOfDecimals position="3" depth="3" />
                <Options downsampleFactor="0" downsampleMinDist="0.0" timeFormat="0" />
                <!-- timeFormat 0 = Default -->
            </Settings>
            </Export>
        </NaviEditTask>
        </ExportVisualSoftNavigationTask>

        <ExportVisualSoftNavigationTask po="4" name="Export Visualsoft Nav STARBORD Coil" logKeyword="NAVxport" output=" ">
        <NaviEditTask version="1.0">
            <SqlServer>localhost</SqlServer>
            <DatabaseName>{NE_database}</DatabaseName>
            <Export type="xyvsoftvev">
            <BlockId>
                {block_id}
            </BlockId>

            <Output>
                <Location outputMethod="0" prefixKPRange="no" combineFiles="no" sortCombined="no">
                    <Path>"{OutputDirectory}"</Path>
                    <AppendPath></AppendPath>
                </Location>

                <DbFolderUsage createSubdir="no" prefixFileName="no" useAsFilename="no"/>
                <Options writeHeader="yes" selectionMethod="0" reduceMethod="0" sortKP="no" interval="10.0"/>
                <!-- interval unit meter-->
            </Output>
            <Units depthScale="1.0" posScale="1.0"/>
            <!-- depth scale is positive down -->
            <Settings>
                <Selection object="{stbd_id}"/> 
                       <!-- object:
                        -2 = depth channel
                        -1 = CRP
                        0 = User Selected specify in UserOffset element below
                        n = UserOffset Id in the NaviEdit database
                        -->
                <Singlebeam maxInterpolDist="-1" interpolateDepth="yes"/>
                <Multibeam averagingWindow="1.0"/> 
                <!-- averaging windows i meter -->
                <NoOfDecimals position="3" depth="3" />
                <Options downsampleFactor="0" downsampleMinDist="0.0" timeFormat="0" />
                <!-- timeFormat 0 = Default -->
            </Settings>
            </Export>
        </NaviEditTask>
        </ExportVisualSoftNavigationTask>
    </GroupTask>
</Setup>
